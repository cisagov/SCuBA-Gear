ProductName: defender
TestPlan:
  - PolicyId: MS.DEFENDER.1.2v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.1.2v1 Non-compliant - std&strict SentTo Non-null, SentToMemberOf Non-null, RecipientDomainIs Non-null
        Preconditions:
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Standard Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Strict Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.1.2v1 Compliant - Std Non-null Strict Null
        Preconditions:
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Standard Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
          - Command: Set-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              SentTo: null
              SentToMemberOf: null
              RecipientDomainIs: null
              Confirm: false
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.1.2v1 Compliant - Std Null Strict Non-null
        Preconditions:
          - Command: Set-EOPProtectionPolicyRule
            Splat:
              Identity: Standard Preset Security Policy
              SentTo: null
              SentToMemberOf: null
              RecipientDomainIs: null
              Confirm: false
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Strict Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.1.2v1 Compliant - std&strict SentTo Null, SentToMemberOf Null, RecipientDomainIs Null
        Preconditions:
          - Command: Set-EOPProtectionPolicyRule
            Splat:
              Identity: Standard Preset Security Policy
              SentTo: null
              SentToMemberOf: null
              RecipientDomainIs: null
              Confirm: false
          - Command: Set-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              SentTo: null
              SentToMemberOf: null
              RecipientDomainIs: null
              Confirm: false
        Postconditions: []
        ExpectedResult: true

  - PolicyId: MS.DEFENDER.1.4v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.1.4v1 Non-compliant Strict Preset Security Policy Disabled
        Preconditions:
          - Command: Disable-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              Confirm: false
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.1.4v1 Non-compliant Mismatched Recipient Domains
        ConfigFileName: MismatchedRecipientDomain.yaml
        Preconditions:
          - Command: Enable-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              Confirm: false
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Strict Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.1.4v1 Non-compliant Mismatched User
        ConfigFileName: MismatchedUser.yaml
        Preconditions:
          - Command: Enable-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              Confirm: false
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Strict Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.1.4v1 Non-compliant Mismatched Group
        ConfigFileName: MismatchedGroup.yaml
        Preconditions:
          - Command: Enable-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              Confirm: false
          - Command: 'Set-EOPProtectionPolicyRule -Identity "Strict Preset Security Policy" -SentTo (Get-MailUser)[0].UserPrincipalName -SentToMemberOf (Get-UnifiedGroup)[0].alias -RecipientDomainIs badpeople.r.us -Confirm:$false'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.1.4v1 Compliant Matched Recipient Domains
        ConfigFileName: MatchedRecipientDomain.yaml
        Preconditions:
          - Command: Enable-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              Confirm: false
          - Command: Set-EOPProtectionPolicyRule
            Splat:
              Identity: Strict Preset Security Policy
              SentTo: null
              SentToMemberOf: null
              RecipientDomainIs:
                - badpeople.r.us
              Confirm: false
        Postconditions: []
        ExpectedResult: true

  - PolicyId: MS.DEFENDER.2.1v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.2.1v1 Non-compliant - Sensitive user not listed
        ConfigFileName: MismatchedUser.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect $null}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.1v1 Non-compliant - Sensitive user partial coverage
        ConfigFileName: MatchedUser.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.1v1 Compliant - All Listed sensitive users (mix-cased) are protected
        ConfigFileName: MatchedWithMixedCase.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.2.1v1 Compliant - All Listed sensitive users are protected
        ConfigFileName: MatchedUser.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.2.1v1 Compliant - No sensitive users identified but all users covered
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedUsersToProtect "AgencyUserGlobalReader;AgencyUserGlobalReader@y2zj1.onmicrosoft.com"}'
        Postconditions: []
        ExpectedResult: true

  - PolicyId: MS.DEFENDER.2.2v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.2.2v1 Non-compliant - Agency domain not listed
        ConfigFileName: AgencyDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.2v1 Non-compliant - Agency domain partial coverage
        ConfigFileName: AgencyDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodguys.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.2v1 Non-compliant - All domains No list
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.2v1 Compliant - All Listed are protected
        ConfigFileName: AgencyDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodguys.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodguys.com"}'
        Postconditions: []
        ExpectedResult: true

  - PolicyId: MS.DEFENDER.2.3v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.2.3v1 Non-compliant - Agency domain not listed
        ConfigFileName: PartnerDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.3v1 Non-compliant - Agency domain partial coverage
        ConfigFileName: PartnerDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodparnter.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: false
      - TestDescription: MS.DEFENDER.2.3v1 Compliant - All Listed are protected
        ConfigFileName: PartnerDomainList.yaml
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodparnter.com"}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect "goodparnter.com"}'
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.2.3v1 Compliant - All domains No list
        Preconditions:
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Strict Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
          - Command: 'Get-AntiPhishPolicy | Where-Object {$_.Identity -like "Standard Preset Security Policy*"} | % {Set-AntiPhishPolicy -Identity $($_.Identity) -TargetedDomainsToProtect $null}'
        Postconditions: []
        ExpectedResult: true

  - PolicyId: MS.DEFENDER.4.1v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.4.1v1 Compliant case - Advanced Rule
        Preconditions:
        - Command: Set-DlpComplianceRule
          Splat:
            Identity: "protection rule 4"
            AdvancedRule: "{rn  'Version': '1.0',rn  'Condition': {rn    'Operator': 'And',rn    'SubConditions': [rn      {rn        'ConditionName': 'ContentContainsSensitiveInformation',rn        'Value': [rn          {rn            'Groups': [rn              {rn                'Name': 'Default',rn                'Operator': 'Or',rn                'Sensitivetypes': [rn                  {rn                    'Name': 'Credit Card Number',rn                    'Id': '50842eb7-edc8-4019-85dd-5a5c1f2bb085',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'High',rn                    'Minconfidence': 85,rn                    'Maxconfidence': 100rn                  },rn                  {rn                    'Name': 'U.S. Individual Taxpayer Identification Number (ITIN)',rn                    'Id': 'e55e2a32-f92d-4985-a35d-a0b269eb687b',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'Medium',rn                    'Minconfidence': 75,rn                    'Maxconfidence': 100rn                  },rn                  {rn                    'Name': 'U.S. Social Security Number (SSN)',rn                    'Id': 'a44669fe-0d48-453d-a9b1-2cc83f2cba77',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'Medium',rn                    'Minconfidence': 75,rn                    'Maxconfidence': 100rn                  }rn                ]rn              }rn            ],rn            'Operator': 'And'rn          }rn        ]rn      }rn    ]rn  }rn}"
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.4.1v1 Compliant case - Not Advanced Rule
        Preconditions:
        - Command: Set-DlpComplianceRule
          Splat:
            Identity: "protection rule 4"
            ContentContainsSensitiveInformation: "@(@{Name=\"U.S. Social Security Number (SSN)\"; minCount=\"1\"; maxCount=\"-1\"},@{Name=\"U.S. Individual Taxpayer Identification Number (ITIN)\"; minCount=\"1\"; maxCount=\"-1\"},@{Name=\"Credit Card Number\"; minCount=\"1\"; maxCount=\"-1\"})"
        Postconditions: []
        ExpectedResult: true
      # - TestDescription: MS.DEFENDER.4.1v1 Non-Compliant case - Advanced Rule
      #   Preconditions:
      #   - Command: Set-DlpComplianceRule
      #     Splat:
      #       Identity: "protection rule 4"
      #       AdvancedRule: "{rn  'Version': '1.0',rn  'Condition': {rn    'Operator': 'And',rn    'SubConditions': [rn      {rn        'ConditionName': 'ContentContainsSensitiveInformation',rn        'Value': [rn          {rn            'Groups': [rn              {rn                'Name': 'Default',rn                'Operator': 'Or',rn                'Sensitivetypes': [rn                  {rn                    'Name': 'NOT Credit Card Number',rn                    'Id': '50842eb7-edc8-4019-85dd-5a5c1f2bb085',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'High',rn                    'Minconfidence': 85,rn                    'Maxconfidence': 100rn                  },rn                  {rn                    'Name': 'U.S. Individual Taxpayer Identification Number (ITIN)',rn                    'Id': 'e55e2a32-f92d-4985-a35d-a0b269eb687b',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'Medium',rn                    'Minconfidence': 75,rn                    'Maxconfidence': 100rn                  },rn                  {rn                    'Name': 'U.S. Social Security Number (SSN)',rn                    'Id': 'a44669fe-0d48-453d-a9b1-2cc83f2cba77',rn                    'Mincount': 1,rn                    'Maxcount': -1,rn                    'Confidencelevel': 'Medium',rn                    'Minconfidence': 75,rn                    'Maxconfidence': 100rn                  }rn                ]rn              }rn            ],rn            'Operator': 'And'rn          }rn        ]rn      }rn    ]rn  }rn}"
      #   Postconditions: []
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.4.1v1 Non-Compliant case - Not Advanced Rule
      #   Preconditions:
      #   - Command: Set-DlpComplianceRule
      #     Splat:
      #       Identity: "protection rule 4"
      #       ContentContainsSensitiveInformation: "@(@{@{Name=\"U.S. Individual Taxpayer Identification Number (ITIN)\"; minCount=\"1\"; maxCount=\"-1\"},@{Name=\"Credit Card Number\"; minCount=\"1\"; maxCount=\"-1\"})"
      #   Postconditions: []
      #   ExpectedResult: false

  # - PolicyId: MS.DEFENDER.4.2v1
  #   TestDriver: RunScuba
  #   Tests:
  #     - TestDescription: MS.DEFENDER.4.2v1 Compliant case
  #       Preconditions:
  #         - Command: Set-DlpComplianceRule
  #           Splat:
  #             displayName: MS.DEFENDER.4.2v1 The custom policy SHOULD be applied to Exchange, OneDrive, SharePoint, Teams chat, and Devices
  #             updates:
  #       Postconditions: []
  #       ExpectedResult: true

  # - PolicyId: MS.DEFENDER.4.3v1
  #   TestDriver: RunScuba
  #   Tests:
  #     - TestDescription: MS.DEFENDER.4.3v1 Compliant case
  #       Preconditions:
  #         - Command: Set-DlpComplianceRule
  #           Splat:
  #             displayName: MS.DEFENDER.4.3v1 custom policy SHOULD be set to block sharing sensitive information with everyone
  #             updates:
  #       Postconditions: []
  #       ExpectedResult: true

  # - PolicyId: MS.DEFENDER.4.4v1
  #   TestDriver: RunScuba
  #   Tests:
  #     - TestDescription: MS.DEFENDER.4.4v1 Compliant case
  #       Preconditions:
  #         - Command: Set-DlpComplianceRule
  #           Splat:
  #             displayName: MS.DEFENDER.4.4v1 Notifications to inform users SHOULD be enabled
  #             updates:
  #       Postconditions: []
  #       ExpectedResult: true

  - PolicyId: MS.DEFENDER.4.5v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.4.5v1 Not Checked
        Preconditions: []
        Postconditions: []
        IsNotChecked: true
        ExpectedResult: false

  - PolicyId: MS.DEFENDER.4.6v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.4.6v1 Not Checked
        Preconditions: []
        Postconditions: []
        IsNotChecked: true
        ExpectedResult: false

  - PolicyId: MS.DEFENDER.5.1v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.5.1v1 Compliant case
        Preconditions:
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "Suspicious email sending patterns detected"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "Suspicious Email Forwarding Activity"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "Messages have been delayed"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "Tenant restricted from sending unprovisioned email"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "User restricted from sending email"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "A potentially malicious URL click was detected"
            Disabled: false
        - Command: Set-ProtectionAlert
          Splat:
            Identity: "Suspicious connector activity"
            Disabled: false
        Postconditions: []
        ExpectedResult: true
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "Suspicious email sending patterns detected"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious email sending patterns detected"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious email sending patterns detected"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "Suspicious Email Forwarding Activity"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious Email Forwarding Activity"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious Email Forwarding Activity"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "Messages have been delayed"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Messages have been delayed"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Messages have been delayed"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "Tenant restricted from sending unprovisioned email"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Tenant restricted from sending unprovisioned email"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Tenant restricted from sending unprovisioned email"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "User restricted from sending email"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "User restricted from sending email"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "User restricted from sending email"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "A potentially malicious URL click was detected"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "A potentially malicious URL click was detected"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "A potentially malicious URL click was detected"
      #       Disabled: false
      #   ExpectedResult: false
      # - TestDescription: MS.DEFENDER.5.1v1 Non-Compliant case - "Suspicious connector activity"
      #   Preconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious connector activity"
      #       Disabled: true
      #   Postconditions:
      #   - Command: Set-ProtectionAlert
      #     Splat:
      #       Identity: "Suspicious connector activity"
      #       Disabled: false
      #   ExpectedResult: false

  - PolicyId: MS.DEFENDER.5.2v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.5.2v1 Not Checked
        Preconditions: []
        Postconditions: []
        IsNotChecked: true
        ExpectedResult: false

  - PolicyId: MS.DEFENDER.6.1v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.6.1v1 Compliant case
        Preconditions:
          - Command: Set-AdminAuditLogConfig
            Splat:
              UnifiedAuditLogIngestionEnabled: true
        Postconditions: []
        ExpectedResult: true
      - TestDescription: MS.DEFENDER.6.1v1 Not-Compliant case
        Preconditions:
          - Command: Set-AdminAuditLogConfig
            Splat:
              UnifiedAuditLogIngestionEnabled: false
        Postconditions: []
        ExpectedResult: false

  - PolicyId: MS.DEFENDER.6.2v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.6.2v1 Not Checked
        Preconditions: []
        Postconditions: []
        IsNotChecked: true
        ExpectedResult: false

  - PolicyId: MS.DEFENDER.6.3v1
    TestDriver: RunScuba
    Tests:
      - TestDescription: MS.DEFENDER.6.3v1 Not Checked
        Preconditions: []
        Postconditions: []
        IsNotChecked: true
        ExpectedResult: false
